<!DOCTYPE html>
<html>
<head>
  <title>African Folktales and Legends</title>
</head>
<body>
  <!-- Display flash messages -->
  <% if (success_msg) { %>
    <div class="success-msg">
      <%= success_msg %>
    </div>
  <% } %>
  <% if (error_msg) { %>
    <div class="error-msg">
      <%= error_msg %>
    </div>
    <% } %>
  <h1>Welcome to African Folktales and Legends</h1>
  <% if (user) { %>
    <p>Hello, <%= user.username %></p>
    <a href="/logout">Logout</a>
  <% } else { %>
    <a href="/login">Login</a>
    <a href="/register">Register</a>
  <% } %>

  <% if (stories.length > 0) { %>
    <h2>Featured Stories</h2>
    <ul>
      <% stories.forEach((story) => { %>
        <li>
          <a href="/stories/<%= story._id %>"><%= story.title %></a>
          <span>Author: <%= story.author %></span>
          <span>Rating: <%= story.ratings.length > 0 ? (story.ratings.reduce((sum, r) => sum + r.rating, 0) / story.ratings.length).toFixed(1) : 'N/A' %></span>
        </li>
      <% }); %>
    </ul>
  <% } else { %>
    <p>No stories available</p>
  <% } %>
</body>
</html>

